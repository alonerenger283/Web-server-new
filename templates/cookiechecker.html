<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cookie Checker - Cookie Server</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: #0f0f23; min-height: 100vh; }
    .header { background: rgba(23, 23, 40, 0.8); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding: 18px 35px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
    .header h1 { font-size: 26px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 700; }
    .btn { padding: 11px 22px; border: none; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
    .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4); }
    .btn-success { background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%); color: white; }
    .btn-success:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(74, 222, 128, 0.4); }
    .container { max-width: 1300px; margin: 30px auto; padding: 0 25px; }
    .card { background: rgba(23, 23, 40, 0.6); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 28px; margin-bottom: 25px; }
    .card h2 { color: #ffffff; font-size: 22px; margin-bottom: 18px; font-weight: 600; }
    textarea { width: 100%; min-height: 220px; padding: 14px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; font-size: 14px; font-family: 'Consolas', monospace; resize: vertical; color: #ffffff; transition: all 0.3s; }
    textarea::placeholder { color: rgba(255, 255, 255, 0.3); }
    textarea:focus { outline: none; background: rgba(255, 255, 255, 0.08); border-color: #667eea; }
    .actions { display: flex; gap: 12px; margin-top: 18px; }
    .status { text-align: center; padding: 16px; background: rgba(96, 165, 250, 0.1); border: 1px solid rgba(96, 165, 250, 0.2); border-radius: 12px; color: #60a5fa; font-weight: 600; margin-top: 18px; }
    .results-section { display: none; }
    .stats { display: flex; gap: 22px; margin-bottom: 25px; flex-wrap: wrap; }
    .stat-box { flex: 1; min-width: 160px; padding: 22px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%); border: 1px solid rgba(102, 126, 234, 0.3); color: white; border-radius: 14px; text-align: center; }
    .stat-number { font-size: 32px; font-weight: 700; margin-bottom: 8px; }
    .stat-label { font-size: 14px; opacity: 0.9; }
    .results-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
    .result-box { background: rgba(30, 33, 62, 0.4); border-radius: 14px; padding: 25px; border: 1px solid rgba(255, 255, 255, 0.1); }
    .result-box h3 { color: #ffffff; font-size: 18px; margin-bottom: 18px; display: flex; align-items: center; gap: 10px; font-weight: 600; }
    .count-badge { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 3px 12px; border-radius: 14px; font-size: 12px; font-weight: 600; }
    .name-list { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 10px; padding: 14px; max-height: 350px; overflow-y: auto; margin-bottom: 16px; }
    .name-item { padding: 10px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); color: rgba(255, 255, 255, 0.9); font-size: 14px; display: flex; align-items: center; gap: 10px; }
    .name-item:last-child { border-bottom: none; }
    .name-number { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 3px 10px; border-radius: 6px; font-size: 12px; font-weight: 600; min-width: 35px; text-align: center; }
    .cookie-box { background: rgba(10, 10, 18, 0.6); border: 1px solid rgba(74, 222, 128, 0.3); border-radius: 10px; padding: 14px; font-family: 'Consolas', monospace; font-size: 13px; color: rgba(255, 255, 255, 0.9); max-height: 450px; overflow-y: auto; white-space: pre-wrap; word-break: break-all; user-select: all; cursor: text; line-height: 1.9; }
    .empty-message { text-align: center; color: rgba(255, 255, 255, 0.4); padding: 35px; font-size: 14px; }
    @media (max-width: 768px) {
      .header { flex-direction: column; gap: 15px; padding: 18px 20px; }
      .actions { flex-direction: column; }
      .btn { width: 100%; }
      .results-grid { grid-template-columns: 1fr; }
      .stats { flex-direction: column; }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üç™ Cookie Checker</h1>
    <button class="btn btn-primary" onclick="window.location.href='/dashboard'">‚Üê Back to Dashboard</button>
  </div>

  <div class="container">
    <div class="card">
      <h2>Enter Cookies</h2>
      <textarea id="cookiesInput" placeholder="Paste your Facebook cookies here, one per line..."></textarea>
      <div class="actions">
        <button class="btn btn-success" onclick="checkCookies()">Check Cookies</button>
      </div>
      <div id="status" class="status" style="display: none;"></div>
    </div>

    <div class="results-section" id="resultsSection">
      <div class="stats" id="stats"></div>
      
      <div class="results-grid">
        <div class="result-box">
          <h3>
            <span>üìã Account Names</span>
            <span class="count-badge" id="namesCount">0</span>
          </h3>
          <div class="name-list" id="namesList"></div>
        </div>

        <div class="result-box">
          <h3>
            <span>‚úì Valid Cookies</span>
            <span class="count-badge" id="cookiesCount">0</span>
          </h3>
          <div class="cookie-box" id="cookiesBox"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let isChecking = false;

    async function checkCookies() {
      if (isChecking) return;

      const cookiesInput = document.getElementById('cookiesInput').value.trim();
      if (!cookiesInput) {
        alert('Please enter cookies to check');
        return;
      }

      const cookies = cookiesInput.split('\n').map(c => c.trim()).filter(c => c);
      if (cookies.length === 0) {
        alert('No valid cookies found');
        return;
      }

      isChecking = true;
      const statusDiv = document.getElementById('status');
      const resultsSection = document.getElementById('resultsSection');
      
      statusDiv.style.display = 'block';
      statusDiv.textContent = `Checking ${cookies.length} cookies...`;
      resultsSection.style.display = 'none';

      try {
        const response = await fetch('/api/tools/check-cookies', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ cookies })
        });

        const data = await response.json();
        
        if (data.success) {
          displayResults(data.results);
        } else {
          statusDiv.textContent = 'Error: ' + data.message;
        }
      } catch (e) {
        statusDiv.textContent = 'Error checking cookies: ' + e.message;
      } finally {
        isChecking = false;
      }
    }

    function displayResults(results) {
      const statusDiv = document.getElementById('status');
      const resultsSection = document.getElementById('resultsSection');
      const statsDiv = document.getElementById('stats');
      const namesList = document.getElementById('namesList');
      const cookiesBox = document.getElementById('cookiesBox');
      const namesCount = document.getElementById('namesCount');
      const cookiesCount = document.getElementById('cookiesCount');

      const validCookies = results.filter(r => r.valid);
      const invalidCookies = results.filter(r => !r.valid);

      statusDiv.style.display = 'none';
      resultsSection.style.display = 'block';

      statsDiv.innerHTML = `
        <div class="stat-box">
          <div class="stat-number">${results.length}</div>
          <div class="stat-label">Total Checked</div>
        </div>
        <div class="stat-box" style="background: linear-gradient(135deg, rgba(74, 222, 128, 0.2) 0%, rgba(34, 197, 94, 0.2) 100%); border-color: rgba(74, 222, 128, 0.3);">
          <div class="stat-number">${validCookies.length}</div>
          <div class="stat-label">Valid</div>
        </div>
        <div class="stat-box" style="background: linear-gradient(135deg, rgba(248, 113, 113, 0.2) 0%, rgba(239, 68, 68, 0.2) 100%); border-color: rgba(248, 113, 113, 0.3);">
          <div class="stat-number">${invalidCookies.length}</div>
          <div class="stat-label">Invalid</div>
        </div>
      `;

      namesCount.textContent = validCookies.length;
      cookiesCount.textContent = validCookies.length;

      if (validCookies.length > 0) {
        namesList.innerHTML = validCookies.map((result, index) => `
          <div class="name-item">
            <span class="name-number">${index + 1}</span>
            <span>${result.name}</span>
          </div>
        `).join('');
      } else {
        namesList.innerHTML = '<div class="empty-message">No valid cookies found</div>';
      }

      if (validCookies.length > 0) {
        const cookiesText = validCookies.map(result => result.cookie).join('\n');
        cookiesBox.textContent = cookiesText;
      } else {
        cookiesBox.innerHTML = '<div class="empty-message">No valid cookies found</div>';
      }
    }
  </script>
</body>
</html>
